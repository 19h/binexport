image: Visual Studio 2015

environment:
  idasdk_secret:
    secure: e8rrgX8BRIaH59lHhkE56P7z9XjkkoN59li6krpEUOE=

matrix:
  fast_finish: true

# TODO(cblichmann): Cache
# cache:

install:
  - set

  - git submodule update --init --recursive
  - mkdir build_msvc

  # IDA SDK
  - C:\OpenSSL-Win32\bin\openssl.exe aes-256-cbc -k "%idasdk_secret%"
    -in third_party\idasdk.zip.enc -out third_party\idasdk.zip -d
  #- 7z x -bt -mmt2 idasdk.zip
  - unzip -q third_party\idasdk.zip -d third_party

  # PostgreSQL client libraries
  - cd third_party
  - curl -fsS -o postgresql-9.5.3.tar.bz2
    https://ftp.postgresql.org/pub/source/v9.5.3/postgresql-9.5.3.tar.bz2
  - tar xaf postgresql-9.5.3.tar.bz2
  - dir
